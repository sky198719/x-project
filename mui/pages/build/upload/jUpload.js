define(["base","loading","fileupload","iframe"],function(e,l){var o=null;return{files:function(a){var i,n,a=a||{},t=a.$dom||e("#J_uploadFile");t.fileupload({url:a.url,autoUpload:!0,type:"post",formData:a.formData||{},acceptFileTypes:/\.(jpg|jpeg|png|doc|docx|xls|xlsx|ppt|pptx|pdf|avi|rmvb|mp4|mp3)$/i,maxFileSize:a.size||524288e3,beforeSend:function(e){i=(new Date).getTime();var l=a.headers||{};for(var o in l)e.setRequestHeader(o,l[o])},add:function(a,i){e.log("add fileupload"),e.log(i),o?o.show():o=l.loading(),i.submit()},success:function(l){if("200000"!=l.code)return e.log(l),!1;var i=null;(i=a.callback)&&i(l.data),o&&o.close()},progressall:function(l,o){e.log("progress all")},fileuploadprogress:function(l,o){var a=parseInt(o.loaded/o.total*100,10);e.log("加载进度：：："+a)},processfail:function(){e.log("processfail")},fail:function(){e.log("file upload fail"),n=(new Date).getTime(),e.log("uploadTime:"+(n-i)),o&&o.close()}})}}});